FROM node:24-slim

# Enable corepack for pnpm
RUN corepack enable

WORKDIR /app

# Copy full workspace (needed for hoisted dependencies)
COPY . .

# Install all dependencies
RUN pnpm install --frozen-lockfile

# Build API
RUN pnpm build:api

# Run worker
CMD ["node", "apps/api/dist/src/worker.js"]
